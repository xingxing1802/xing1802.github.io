require(["vue","layers"],function(a){var b=new a({el:"#app",data:{urlStr:"",threadNum:6,timeout:8,linkArr:[],finishStatus:false},methods:{getTipWord:function(c){switch(c){case 0:return"队列中...";case 1:return"检查中...";case 2:return"有效链接";case 3:return"失效链接";default:return"未知状态？"}},showDemo:function(){this.urlStr=decodeURIComponent("http%3A%2F%2Fwhoisx.co.uk%2F%23domain%23%0Ahttp%3A%2F%2Fwww.100soo.cn%2FSearchPlayFile.aspx%3F%23domain%23%0Ahttp%3A%2F%2Fsearch.cnki.net%2Fsearch.aspx%3Fq%3D%23domain%23%0Ahttp%3A%2F%2Fnews.baidu.com%2Fns%3Fcl%3D2%26rn%3D20%26tn%3Dnews%26word%3D%23domain%23%0Ahttp%3A%2F%2F365codes.cn%2Falexa%2FIndex.asp%3Furl%3D%23domain%23%0Ahttp%3A%2F%2Fwww.uisdc.com%2F%3Fs%3D%23domain%23");this.check()},check:function(){var e=this;if(""==this.urlStr){layer.msg("无效的链接列表！");return}this.linkArr=[];this.finishStatus=false;layer.msg("检查已开始...");var d=this.urlStr.split("\n"),h=[];for(var g=0;g<d.length;g++){var f=d[g].replace(/(^s*)/g,"");if(""!=f){h.push({url:f,status:0})}}this.linkArr=h;var c=function(j){(function(){if(e.linkArr.length<=j){var k=setInterval(function(){var n=0,p=e.linkArr.length;for(var o=0;o<p;o++){if(0!=e.linkArr[o]["status"]&&1!=e.linkArr[o]["status"]){n+=1}}if(n==p){e.finishStatus=true;clearInterval(k);layer.msg("队列处理完成！",{icon:6})}},200);return}var i=true;for(var m=j;m<e.linkArr.length;m++){if(0==e.linkArr[m]["status"]){i=false;e.linkArr[m]["status"]=1;var l=e.linkArr[m]["url"];require([l],function(){e.linkArr[m]["status"]=2;c(m+1)},function(){e.linkArr[m]["status"]=3;c(m+1)});break}}})(j)};for(var g=0;g<this.threadNum;g++){c(g)}},export2excel:function(){var c=this;if(!this.finishStatus){layer.msg("任务善未完成！");return}require(["xlsx"],function(f){var g=f.utils.book_new();var d=[{id:"ID",url:"链接",status:"状态"}];c.linkArr.forEach(function(i,h){d.push({id:h+1,url:i.url,status:c.getTipWord(i.status)})});var e=f.utils.json_to_sheet(d,{header:["id","url","status"],skipHeader:true});f.utils.book_append_sheet(g,e,"全部链接");d=[{id:"ID",url:"链接",status:"状态"}];c.linkArr.forEach(function(i,h){if(3==i.status){d.push({id:h+1,url:i.url,status:c.getTipWord(i.status)})}});var e=f.utils.json_to_sheet(d,{header:["id","url","status"],skipHeader:true});f.utils.book_append_sheet(g,e,"死链");d=[{id:"ID",url:"链接",status:"状态"}];c.linkArr.forEach(function(i,h){if(2==i.status){d.push({id:h+1,url:i.url,status:c.getTipWord(i.status)})}});var e=f.utils.json_to_sheet(d,{header:["id","url","status"],skipHeader:true});f.utils.book_append_sheet(g,e,"有效链接");f.writeFile(g,"死链列表.xlsx");layer.msg("下载即将开始...")})}},mounted:function(){require.config({waitSeconds:this.timeout})}})});